<html>

    <head>
        <title>ninja-cat famicom cartridges</title>
    </head>

    <body>
        <script src="http://code.jquery.com/jquery.min.js" type="text/javascript"></script>
        <script type="text/javascript">
           
            var groups = {}
 
            function create_groups(data){
                var groups = {};
                var all_carts = 0;
                $.each(data, function(cart_id, value){
                    var group = value['group'];
                    if (!(group in groups)){
                        groups[group] = [];
                    }; 
                    groups[group].push(cart_id);
                    all_carts ++;
                });
                groups['all'] = all_carts;
                return groups;
             }

            function check_all_groups(){
                items = $("input","ul#fami_tags li");
                checked = items[0].checked;
                $.each(items, function(idx, val){
                    if (idx > 0) {
                        val.checked = checked;
                    }
                });
                return true;
            }

            function create_group_checkboxes(groups){
                inputs = $("ul#fami_tags");
                inputs.empty();
                $.each(groups, function(group, value){
                    listItem = document.createElement("li");
                    inputItem = document.createElement("input");
                    inputItem.type = "checkbox";
                    inputItem.name = group;
                    inputItem.value = group;
                    listItem.appendChild(inputItem);
                    if (group == 'all'){
                        labeltext = document.createTextNode(group + ' ('+ value + '):');
                        inputItem.onchange = check_all_groups;
                        inputs.prepend(listItem);
                    } else {
                        labeltext = document.createTextNode(group + ' ('+ value.length + ');');
                        inputs.append(listItem);
                    }
                    listItem.appendChild(labeltext);
                });
            }

            function load_cart_db(){
                $.getJSON('cart.js', function(data){
                    groups = create_groups(data);
                    create_group_checkboxes(groups);  
                });
            }

            load_cart_db();
        
        </script>

        <div>
            <ul id="fami_tags">
            </ul>
        </div>

        <hr>

        <table border="0">
            <tr>
                <td style="vertical-align: top;">
                    <div id="cart_list" >
                        <select name="carts" size="33" multiple="multiple">
                            <option selected="selected">Robocop 3</option>
                            <option>Jurassic Park</option>
                            <option>Ninja Gaiden 3 Secret of Sacred Stone</option>
                            <option>Contra</option>
                        </select>
                    </div>
                </td>
                <td style="vertical-align: top;">
                    <div id="shock_content" style="overflow:auto;">
                        <ul>
                            <li>title: Contra</li>
                            <li>publisher: konami</li>
                            <li>catalog number: rc826</li>
                            <li> <img src=""></li>
                        </ul>
                    </div>
                </td>
          </tr>
        </table>

    </body>
</html>
